#ifndef CUBEESPOTENTIALS__H__
#define CUBEESPOTENTIALS__H__

 
#include <cstdio>
#include <random>
#include <math.h>
#include <fstream>
#include <ctime>
#include <iostream>
#include <vector>
#include <cmath>
 
  using namespace std;
 
//this function calculates the electrostatic potential for a cube of unit surface potential along the line defined by (0,0,z), i.e. above the centre of the upper face of the cube.
//the approximation is found through an expansion of the unknown potential in spherical harmonics up to the l = 8 terms and is a reasonably good approximation for kappa*R < 10 (or thereabouts). 
//for larger values of kappa*R it's probably more efficient to just use the planar approximation.
double CubeElectrostaticOrder8(const double R , const double kappa, const double h){
double kappaR = kappa*R;
double sqrt5 = sqrt(5);
double z= h+R;
double res = (exp(kappa*(R - z))*R*(779625*pow(R,8)*(3230541090*sqrt5 + 1615270545*kappaR*(5 + 4*sqrt5) + 100*pow(kappaR,12)*(-5 + 6*sqrt5) + 25*pow(kappaR,11)*(43 + 560*sqrt5) +           50*pow(kappaR,10)*(2240 + 4331*sqrt5) + 75*pow(kappaR,9)*(21803 + 31592*sqrt5) + 75*pow(kappaR,8)*(205259 + 245414*sqrt5) + 630*pow(kappaR,5)*(2666675 + 2526476*sqrt5) +           630*pow(kappaR,4)*(7231537 + 6223006*sqrt5) + 15*pow(kappaR,7)*(6792819 + 7090606*sqrt5) + 378*pow(kappaR,2)*(42732025 + 16843859*sqrt5) + 6*pow(kappaR,6)*(80555300 + 78423979*sqrt5) +           63*pow(kappaR,3)*(163012385 + 100642548*sqrt5)) + 779625*kappaR*pow(R,7)*        (3230541090*sqrt5 + 1615270545*kappaR*(5 + 4*sqrt5) + 100*pow(kappaR,12)*(-5 + 6*sqrt5) + 25*pow(kappaR,11)*(43 + 560*sqrt5) + 50*pow(kappaR,10)*(2240 + 4331*sqrt5) +           75*pow(kappaR,9)*(21803 + 31592*sqrt5) + 75*pow(kappaR,8)*(205259 + 245414*sqrt5) + 630*pow(kappaR,5)*(2666675 + 2526476*sqrt5) + 630*pow(kappaR,4)*(7231537 + 6223006*sqrt5) +           15*pow(kappaR,7)*(6792819 + 7090606*sqrt5) + 378*pow(kappaR,2)*(42732025 + 16843859*sqrt5) + 6*pow(kappaR,6)*(80555300 + 78423979*sqrt5) + 63*pow(kappaR,3)*(163012385 + 100642548*sqrt5))*z        + 45*pow(R,6)*(4000*pow(kappaR,15) + 149794981639380*sqrt5 + 74897490819690*kappaR*(5 + 4*sqrt5) + 1500*pow(kappaR,14)*(-2455 + 3218*sqrt5) + 125*pow(kappaR,13)*(183699 + 892720*sqrt5) +           50*pow(kappaR,12)*(24488380 + 34243791*sqrt5) + 75*pow(kappaR,11)*(241983293 + 247286040*sqrt5) + 155925*pow(kappaR,5)*(1991955343 + 284574940*sqrt5) +           62370*pow(kappaR,4)*(10564099811 + 1000830451*sqrt5) + 4914*pow(kappaR,6)*(22077078925 + 5574571072*sqrt5) + 1890*pow(kappaR,7)*(16331111548 + 6067446947*sqrt5) +           37422*pow(kappaR,2)*(20014293950 + 8036148577*sqrt5) + 15*pow(kappaR,10)*(12027097375 + 9473028162*sqrt5) + 75*pow(kappaR,9)*(17434258159 + 10751005302*sqrt5) +           315*pow(kappaR,8)*(22759550565 + 11066336006*sqrt5) + 6237*pow(kappaR,3)*(142179634655 + 24946474444*sqrt5))*pow(z,2) +        45*kappaR*pow(R,5)*(4000*pow(kappaR,15) + 149794981639380*sqrt5 + 74897490819690*kappaR*(5 + 4*sqrt5) + 3000*pow(kappaR,14)*(-265 + 454*sqrt5) + 250*pow(kappaR,13)*(67017 + 122960*sqrt5) +           100*pow(kappaR,12)*(5776190 + 4616133*sqrt5) + 600*pow(kappaR,11)*(14508871 + 8105280*sqrt5) + 374220*pow(kappaR,4)*(1511413156 + 68549231*sqrt5) +           103950*pow(kappaR,5)*(2417389667 + 74613492*sqrt5) + 30*pow(kappaR,10)*(3050121875 + 1193349456*sqrt5) + 1890*pow(kappaR,7)*(11197762173 + 1203980647*sqrt5) +           150*pow(kappaR,9)*(4794276107 + 1280677686*sqrt5) + 2268*pow(kappaR,6)*(36233080400 + 2095498531*sqrt5) + 49896*pow(kappaR,3)*(16837691285 + 2370498868*sqrt5) +           315*pow(kappaR,8)*(13898467565 + 2439698316*sqrt5) + 24948*pow(kappaR,2)*(30021440925 + 11306412428*sqrt5))*pow(z,3) +        3*pow(R,4)*(26000*pow(kappaR,17) - 12841389134876610*sqrt5 - 6420694567438305*kappaR*(5 + 4*sqrt5) + 500*pow(kappaR,16)*(-1963 + 7626*sqrt5) + 125*pow(kappaR,15)*(795957 + 648944*sqrt5) +           150*pow(kappaR,14)*(18451720 + 7614083*sqrt5) + 150*pow(kappaR,13)*(274979861 + 72522028*sqrt5) - 3150*pow(kappaR,10)*(-6314795089 + 89735028*sqrt5) +           60*pow(kappaR,12)*(7226182965 + 1093419947*sqrt5) + 60*pow(kappaR,11)*(56328451325 + 3517904212*sqrt5) - 935550*pow(kappaR,4)*(29703309223 + 8565945768*sqrt5) -           630*pow(kappaR,9)*(-138970322801 + 13403635834*sqrt5) - 1309770*pow(kappaR,2)*(49021542465 + 18511202333*sqrt5) - 654885*pow(kappaR,3)*(81854490065 + 25534536836*sqrt5) -           49896*pow(kappaR,5)*(171321429875 + 62808995478*sqrt5) - 1701*pow(kappaR,7)*(-241446586185 + 175304624588*sqrt5) - 126*pow(kappaR,8)*(-2138803094955 + 490763778638*sqrt5) -           1134*pow(kappaR,6)*(857563352580 + 946509936989*sqrt5))*pow(z,4) + 3*kappaR*pow(R,3)*        (6000*pow(kappaR,17) + pow(kappaR,12)*(64955501025 - 7102282830*sqrt5) - 12841389134876610*sqrt5 - 6420694567438305*kappaR*(5 + 4*sqrt5) + 2000*pow(kappaR,16)*(53 + 234*sqrt5) +           1500*pow(kappaR,15)*(14621 + 5512*sqrt5) + 200*pow(kappaR,14)*(2632315 + 423111*sqrt5) + 75*pow(kappaR,13)*(95517207 + 3276656*sqrt5) - 1575*pow(kappaR,10)*(-503339213 + 893840834*sqrt5) -           3929310*pow(kappaR,2)*(16340514155 + 6361013101*sqrt5) - 15*pow(kappaR,11)*(-24828529675 + 9014017802*sqrt5) - 630*pow(kappaR,9)*(13596061669 + 16872946639*sqrt5) -           654885*pow(kappaR,3)*(84713674915 + 27821884716*sqrt5) - 187110*pow(kappaR,4)*(168530840065 + 50267629067*sqrt5) - 2268*pow(kappaR,7)*(346750288955 + 132432651616*sqrt5) -           252*pow(kappaR,8)*(456681755085 + 249834674089*sqrt5) - 6237*pow(kappaR,5)*(2036600986025 + 591309435044*sqrt5) - 1134*pow(kappaR,6)*(3269135911855 + 1027191739564*sqrt5))*pow(z,5) +        pow(kappaR,2)*pow(R,2)*(2000*pow(kappaR,17) - 16510357459127070*sqrt5 + 24000*pow(kappaR,16)*(3 + 4*sqrt5) - 8255178729563535*kappaR*(5 + 4*sqrt5) + 1000*pow(kappaR,15)*(6843 + 316*sqrt5) -           200*pow(kappaR,14)*(-602555 + 154638*sqrt5) - 75*pow(kappaR,13)*(-9319369 + 12598128*sqrt5) - 15*pow(kappaR,12)*(683911555 + 1073368974*sqrt5) -           225*pow(kappaR,10)*(18111343013 + 7904829482*sqrt5) - 3180870*pow(kappaR,2)*(25952581305 + 10170060451*sqrt5) - 15*pow(kappaR,11)*(20264497775 + 12867392574*sqrt5) -           270*pow(kappaR,9)*(137832426737 + 48510380787*sqrt5) - 756*pow(kappaR,8)*(336542308465 + 103606699171*sqrt5) - 1512*pow(kappaR,7)*(889853661065 + 252669684138*sqrt5) -           93555*pow(kappaR,3)*(768141443935 + 254971658204*sqrt5) - 1134*pow(kappaR,6)*(4881512468785 + 1339516072568*sqrt5) - 5670*pow(kappaR,4)*(7339228985715 + 2202485143733*sqrt5) -           1701*pow(kappaR,5)*(10295303171775 + 2877820647676*sqrt5))*pow(z,6) -        pow(kappaR,3)*R*(4000*pow(kappaR,16) + 3668968324250460*sqrt5 + 1834484162125230*kappaR*(5 + 4*sqrt5) + 12000*pow(kappaR,15)*(9 + 26*sqrt5) + 1000*pow(kappaR,14)*(13133 + 11244*sqrt5) +           300*pow(kappaR,13)*(1525455 + 789836*sqrt5) + 150*pow(kappaR,12)*(60742129 + 23785004*sqrt5) + 30*pow(kappaR,11)*(4179208865 + 1373048906*sqrt5) +           1871100*pow(kappaR,3)*(8557143037 + 2850808908*sqrt5) + 1122660*pow(kappaR,2)*(16340514155 + 6418196798*sqrt5) + 45*pow(kappaR,10)*(28606480565 + 8415105388*sqrt5) +           1260*pow(kappaR,8)*(51335507367 + 13559167279*sqrt5) + 90*pow(kappaR,9)*(113971939145 + 31317720101*sqrt5) + 9072*pow(kappaR,6)*(142139103650 + 37370901153*sqrt5) +           22680*pow(kappaR,5)*(175627111243 + 48481408704*sqrt5) + 1512*pow(kappaR,7)*(214739789495 + 55810204314*sqrt5) + 4536*pow(kappaR,4)*(2057021154375 + 618556592986*sqrt5))*pow(z,7) +        2*(1000*pow(kappaR,19) + 137891678662861200*sqrt5 + 68945839331430600*kappaR*(5 + 4*sqrt5) + 1000*pow(kappaR,18)*(-37 + 168*sqrt5) + 4500*pow(kappaR,17)*(429 + 1772*sqrt5) +           150*pow(kappaR,16)*(981115 + 1373738*sqrt5) + 600*pow(kappaR,15)*(6889289 + 6195646*sqrt5) + 808315200*pow(kappaR,5)*(327181303 + 145876967*sqrt5) +           1650310200*pow(kappaR,2)*(417775030 + 206420991*sqrt5) + 45*pow(kappaR,14)*(1622569085 + 1136056936*sqrt5) + 270*pow(kappaR,13)*(3461550280 + 2072129573*sqrt5) +           137525850*pow(kappaR,3)*(5148192155 + 2280343592*sqrt5) + 3240*pow(kappaR,11)*(22523206782 + 11315541857*sqrt5) + 180*pow(kappaR,12)*(51330539320 + 27701397901*sqrt5) +           561330*pow(kappaR,7)*(68229183455 + 30704147764*sqrt5) + 3024*pow(kappaR,10)*(155105736385 + 74091774098*sqrt5) + 374220*pow(kappaR,6)*(298622399300 + 134065927703*sqrt5) +           1122660*pow(kappaR,4)*(442468019175 + 195072351664*sqrt5) + 1512*pow(kappaR,9)*(1636673514790 + 755744546883*sqrt5) + 2268*pow(kappaR,8)*(4736007600225 + 2145893611769*sqrt5))*pow(z,8)))/   ((246518574692155920*sqrt5 + 4000*pow(kappaR,18)*(-23 + 30*sqrt5) + 37000*pow(kappaR,16)*(547 + 4878*sqrt5) + 1000*pow(kappaR,17)*(-2033 + 6424*sqrt5) +        1200*pow(kappaR,15)*(1414215 + 2900563*sqrt5) + 3900*pow(kappaR,14)*(10456193 + 13004416*sqrt5) + 47151720*kappaR*(13070497465 + 9835746538*sqrt5) +        35925120*pow(kappaR,3)*(31051108215 + 13777960319*sqrt5) + 30*pow(kappaR,13)*(20774061635 + 19494977532*sqrt5) + 135*pow(kappaR,12)*(51938895405 + 40546520044*sqrt5) +        2245320*pow(kappaR,2)*(516376693245 + 245861529016*sqrt5) + 374220*pow(kappaR,4)*(1953322454385 + 897176742536*sqrt5) + 45*pow(kappaR,11)*(1368728860175 + 937278603582*sqrt5) +        270*pow(kappaR,10)*(1610322364882 + 998934928685*sqrt5) + 37422*pow(kappaR,5)*(9693956514150 + 4665701413483*sqrt5) + 108*pow(kappaR,9)*(23156358037345 + 13307061791572*sqrt5) +        189*pow(kappaR,8)*(62324216980035 + 33783900881216*sqrt5) + 567*pow(kappaR,7)*(80086212616185 + 41551954180258*sqrt5) + 567*pow(kappaR,6)*(251725606519695 + 125967434444674*sqrt5))*pow(z,9));
return res;
}

 

#endif
